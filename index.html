<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>××¨×’×•×Ÿ ×•×¡×“×¨ â€“ ×”×‘×™×ª ×©×œ×™</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Heebo:wght@300;400;500;700&display=swap" rel="stylesheet">
  <style>
    body{font-family:'Heebo',sans-serif;background:linear-gradient(180deg,#fff7ff,#f7f2ff);}
    .card{background:#fff;border-radius:18px;box-shadow:0 12px 30px rgba(0,0,0,.08);}
    .badge{font-size:.8rem;background:#f1e8ff;color:#6b21a8;border-radius:999px;padding:.25rem .6rem}
    .btn{border-radius:12px;padding:.6rem 1rem}
    .btn-ghost{background:#f6f6fb}
    .tiny{font-size:.9rem;color:#6b7280}
    .link{color:#6d28d9;text-decoration:underline}
  </style>
</head>
<body class="min-h-screen">
  <header class="max-w-3xl mx-auto px-4 pt-6">
    <h1 class="text-3xl font-bold text-gray-800">ğŸ  ××¨×’×•×Ÿ ×•×¡×“×¨</h1>
    <p class="tiny mt-1">××©×™××•×ª ×§×¦×¨×•×ª ×œ×™××™× ×¢××•×¡×™× + ××©×™××” ×’×“×•×œ×” ×œ×¡×•×¤×´×©. × ×©××¨ ××•×˜×•××˜×™×ª.</p>
  </header>

  <main class="max-w-3xl mx-auto px-4 pb-24 space-y-6">

    <!-- ×”×ª×¨××•×ª -->
    <section class="card p-5">
      <div class="flex items-center justify-between gap-3">
        <div>
          <h2 class="text-lg font-semibold text-gray-800">ğŸ”” ×ª×–×›×•×¨×ª ×™×•××™×ª</h2>
          <p class="tiny">×”×ª×¨××” ×‘×™×Ÿ 21:00â€“22:00 ×œ×”×–×›×™×¨ ×œ×¡×™×™× ××©×™××•×ª. × ×©××¨ ×‘××›×©×™×¨.</p>
        </div>
        <div class="flex gap-2">
          <button id="btn-notify-toggle" class="btn btn-ghost">×”×¤×¢×œ ×ª×–×›×•×¨×ª</button>
          <button id="btn-notify-test" class="btn bg-purple-600 text-white hover:bg-purple-700">×‘×“×™×§×ª ×ª×–×›×•×¨×ª</button>
        </div>
      </div>
      <p id="notify-status" class="tiny mt-2"></p>
    </section>

    <!-- ××©×™××•×ª ×™×•××™×•×ª -->
    <section class="card p-5">
      <div class="flex items-center justify-between">
        <h2 class="text-xl font-bold text-gray-800">ğŸ¯ ×¤×•×§×•×¡ ×™×•××™ â€“ 3 ××©×™××•×ª ×§×œ×•×ª</h2>
        <span id="today-badge" class="badge"></span>
      </div>
      <div id="daily-list" class="mt-4 grid gap-3"></div>
      <p class="tiny mt-3">×˜×™×¤: 10 ×“×§×³ ×œ×›×œ ××©×™××”. ××¤×©×¨ ×œ×©×ª×£ ×¢× ××¤×œ (10) ×•××¢×™×™×Ÿ (8) ğŸ˜‡</p>
    </section>

    <!-- ××•×¨×›×‘×•×ª ×œ×¡×•×¤"×© -->
    <section class="card p-5">
      <div class="flex items-center justify-between">
        <h2 class="text-xl font-bold text-gray-800">ğŸ§± ××•×¨×›×‘×•×ª ×œ×¡×•×¤×´×©</h2>
        <span class="badge">30â€“60 ×“×³</span>
      </div>
      <p class="tiny mt-1">×‘×™××™ ×©×™×©×™â€“×©×‘×ª ×ª×•×¤×™×¢ ×›××Ÿ ××©×™××” ××—×ª ××¡×“×¨×•×ª ×”××¨×’×•×Ÿ.</p>
      <div id="weekly-card" class="mt-4"></div>
    </section>

    <!-- ×ª×›× ×™×ª ×××•×§×“×ª ×œ××–×•×¨ (×”×“×‘×§×” â†’ ×¦'×§Ö¾×œ×™×¡×˜) -->
    <section class="card p-5" id="area-plan">
      <div class="flex items-center justify-between">
        <h2 class="text-xl font-bold text-gray-800">ğŸ“Œ ×ª×›× ×™×ª ×××•×§×“×ª ×œ××–×•×¨</h2>
        <button id="btn-show-all" class="btn btn-ghost text-sm">×”×¦×’ ×”×›×•×œ ğŸ‘€</button>
      </div>
      <p class="tiny mt-1">×”×“×‘×™×§×™ ×›××Ÿ ×¦×¢×“×™× â€“ ×›×œ ×©×•×¨×” ×”×•×¤×›×ª ×œ×¡×¢×™×£:</p>
      <textarea id="steps-input" rows="5" class="w-full mt-3 rounded-xl border border-gray-200 p-3 focus:outline-none focus:ring-2 focus:ring-purple-400" placeholder="1. ×œ××¡×•×£ × ×¢×œ×™×™×&#10;2. ×œ×¨×•×§×Ÿ ××ª ×”×©×•×œ×—×Ÿ&#10;3. ×œ××™×™×Ÿ ×›×‘×™×¡×”&#10;..."></textarea>
      <div class="flex flex-wrap gap-2 mt-3">
        <button id="btn-build-checklist" class="btn bg-purple-600 text-white hover:bg-purple-700">×¦×•×¨/×¢×“×›×Ÿ ×¦×³×§Ö¾×œ×™×¡×˜ âœ…</button>
        <button id="btn-hide-done" class="btn btn-ghost">×”×¡×ª×¨ ×©×”×•×©×œ× ğŸ§¹</button>
        <button id="btn-clear" class="btn btn-ghost">× ×§×” ×¦×³×§Ö¾×œ×™×¡×˜ ğŸ—‘ï¸</button>
      </div>
      <div id="checklist" class="mt-4 space-y-2"></div>
      <p class="tiny mt-3">×˜×™×¤: ×©×œ×—×™ ×œ×™ ×ª××•× ×•×ª ×©×œ ××–×•×¨ ××¡×•×™× ×•×× ×™ ××™×™×¦×¨ ×œ×š ×›××Ÿ ×ª×›× ×™×ª ××“×•×™×™×§×ª ×¢× ×¦×¢×“×™× ×§×˜× ×™×.</p>
    </section>

    <footer class="text-center tiny text-gray-500">
      × ×‘× ×” ×‘×™×—×“ ×¢× ×¡×˜×¤× ×™ ğŸ’œ â€“ × ×©××¨ ××§×•××™×ª ×‘×“×¤×“×¤×Ÿ.
    </footer>
  </main>

  <script>
  /* ========== × ×ª×•× ×™ ××©×™××•×ª (×¢× ×§×™×©×•×¨×™ ×•×™×“××• ×œ×¤×™ × ×•×©×) ========== */
  const dailyTasks = [
    { id:'sofa', icon:'ğŸ›‹ï¸', title:'×¡×¤×” â€“ ××™×¡×•×£ ×•××™×•×Ÿ', time:'10 ×“×³', tip:'×œ×”×•×¨×™×“ ×”×›×•×œ ××”×¡×¤×”, ×œ××™×™×Ÿ × ×§×™/××œ×•×›×œ×š', video:'https://www.youtube.com/results?search_query=%D7%A1%D7%93%D7%A8+%D7%A1%D7%9C%D7%95%D7%9F+%D7%A0%D7%99%D7%A7%D7%99%D7%95%D7%9F+%D7%A1%D7%A4%D7%94' },
    { id:'coffee', icon:'â˜•', title:'×©×•×œ×—×Ÿ ×¡×œ×•×Ÿ â€“ ×¤×™× ×•×™ ××œ×', time:'10 ×“×³', tip:'×œ×¤× ×•×ª ×œ×’××¨×™ ×•×œ× ×’×‘ ×¢× ××’×‘×•×Ÿ', video:'https://www.youtube.com/results?search_query=%D7%A1%D7%93%D7%A8+%D7%A9%D7%95%D7%9C%D7%97%D7%9F+%D7%A1%D7%9C%D7%95%D7%9F' },
    { id:'shoes', icon:'ğŸ‘Ÿ', title:'× ×¢×œ×™×™× ×‘×›× ×™×¡×”', time:'5 ×“×³', tip:'×œ××¡×•×£ ×œ×”×—×–×™×¨ ×œ××¨×•×Ÿ/×¡×œ', video:'https://www.youtube.com/results?search_query=%D7%90%D7%A8%D7%92%D7%95%D7%9F+%D7%A0%D7%A2%D7%9C%D7%99%D7%99%D7%9D' },
    { id:'trash', icon:'ğŸ—‘ï¸', title:'××™× ×™-××©×¤×” ××”×™×¨×”', time:'5 ×“×³', tip:'×œ×¡×™×‘×•×‘ ××”×™×¨ ×¢× ×©×§×™×ª, ×¨×§ ×–×‘×œ ×’×œ×•×™', video:'https://www.youtube.com/results?search_query=%D7%98%D7%99%D7%A4%D7%99%D7%9D+%D7%9C%D7%A0%D7%99%D7%A7%D7%99%D7%95%D7%9F+%D7%9E%D7%94%D7%99%D7%A8' },
    { id:'surfaces', icon:'ğŸ§½', title:'××©×˜×—×™ ××˜×‘×— â€“ × ×™×’×•×‘', time:'10 ×“×³', tip:'×œ×¤× ×•×ª 3 ×¤×¨×™×˜×™×, ×œ× ×’×‘, ×œ×”×—×–×™×¨ ××¡×•×“×¨', video:'https://www.youtube.com/results?search_query=%D7%90%D7%A8%D7%92%D7%95%D7%9F+%D7%9E%D7%98%D7%91%D7%97+%D7%9E%D7%94%D7%99%D7%A8' },
    { id:'desk', icon:'ğŸ’»', title:'×©×•×œ×—×Ÿ ×¢×‘×•×“×” â€“ 10 ×¤×¨×™×˜×™×', time:'10 ×“×³', tip:'×œ×¡×“×¨/×œ×–×¨×•×§ 10 ×¤×¨×™×˜×™× ×‘×œ×‘×“', video:'https://www.youtube.com/results?search_query=%D7%A1%D7%93%D7%A8+%D7%A9%D7%95%D7%9C%D7%97%D7%9F+%D7%A2%D7%91%D7%95%D7%93%D7%94' },
    { id:'bath-sink', icon:'ğŸš¿', title:'×›×™×•×¨ ×××‘×˜×™×”', time:'5 ×“×³', tip:'×©×˜×™×¤×”/××’×‘ ××”×™×¨×”', video:'https://www.youtube.com/results?search_query=%D7%A0%D7%99%D7%A7%D7%95%D7%99+%D7%9B%D7%99%D7%95%D7%A8+%D7%90%D7%9E%D7%91%D7%98%D7%99%D7%94' },
    { id:'laundry', icon:'ğŸ§º', title:'×›×‘×™×¡×” â€“ ×¡×‘×‘ ××—×“', time:'5 ×“×³ ×”×•×¦××”', tip:'×œ×”×›× ×™×¡/×œ×”×•×¦×™× ×¡×‘×‘ ××—×“ ×‘×œ×‘×“', video:'https://www.youtube.com/results?search_query=%D7%9E%D7%99%D7%95%D7%9F+%D7%9B%D7%91%D7%99%D7%A1%D7%94+%D7%9E%D7%94%D7%99%D7%A8' },
  ];

  const weekendTasks = [
    { id:'wardrobe', icon:'ğŸ‘—', title:'×¡×™×“×•×¨ ××¨×•×Ÿ ×‘×’×“×™× â€“ ××“×£ ××—×“', tip:'×¨×§ ××“×£/××’×™×¨×” ××—×ª. ××™×•×Ÿ: ×œ×©××•×¨ / ×œ×ª×¨×•× / ×œ×–×¨×•×§', video:'https://www.youtube.com/results?search_query=%D7%A1%D7%99%D7%93%D7%95%D7%A8+%D7%90%D7%A8%D7%95%D7%9F+%D7%91%D7%92%D7%93%D7%99%D7%9D' },
    { id:'kitchen-cab', icon:'ğŸ—„ï¸', title:'××¨×•×Ÿ ××˜×‘×— â€“ ××“×£ ×ª×‘×œ×™× ×™×', tip:'×œ×”×•×¦×™× ×”×›×•×œ, ×œ× ×’×‘, ×œ×”×—×–×™×¨ ×œ×¤×™ ×§×˜×’×•×¨×™×•×ª', video:'https://www.youtube.com/results?search_query=%D7%90%D7%A8%D7%92%D7%95%D7%9F+%D7%90%D7%A8%D7%95%D7%9F+%D7%9E%D7%98%D7%91%D7%97' },
    { id:'utility', icon:'ğŸ§°', title:'×—×“×¨ ×©×™×¨×•×ª â€“ ×¡×œ ××—×¡×•×Ÿ ××—×“', tip:'×œ×‘×—×•×¨ ×¡×œ/×¤×™× ×” ××—×ª ×•×œ×¡×“×¨ ×¢×“ ×¡×™×•×', video:'https://www.youtube.com/results?search_query=%D7%90%D7%A8%D7%92%D7%95%D7%9F+%D7%97%D7%93%D7%A8+%D7%A9%D7%99%D7%A8%D7%95%D7%AA' },
    { id:'kids-room', icon:'ğŸ§¸', title:'×—×“×¨ ××©×—×§×™× â€“ ××“×£ ×¦×¢×¦×•×¢×™×', tip:'×§×•×¤×¡×” ×œ×¦×¢×¦×•×¢×™× ×—×¡×¨×™×, ×§×•×¤×¡×” ×œ×ª×¨×•××”', video:'https://www.youtube.com/results?search_query=%D7%90%D7%A8%D7%92%D7%95%D7%9F+%D7%97%D7%93%D7%A8+%D7%9E%D7%A9%D7%97%D7%A7%D7%99%D7%9D' },
    { id:'parents-shelves', icon:'ğŸ›ï¸', title:'×—×“×¨ ×”×•×¨×™× â€“ ×©×™×“×•×ª ×•××“×£ ××—×“', tip:'×œ×¡×™×™× ××“×£/×©×™×“×” ×¢×“ × ×§×™ ×•××¡×•×“×¨', video:'https://www.youtube.com/results?search_query=%D7%A1%D7%93%D7%A8+%D7%97%D7%93%D7%A8+%D7%A9%D7%99%D7%A0%D7%94' },
  ];

  /* ========== ×¢×–×¨: ×‘×—×™×¨×” ×™×¦×™×‘×” ×œ×¤×™ ×ª××¨×™×š ========== */
  function seedPick(arr, count){
    const d = new Date(); const seed = d.getFullYear()*10000+(d.getMonth()+1)*100+d.getDate();
    const out = []; let s = seed;
    const used = new Set();
    while(out.length<count && used.size<arr.length){
      s = (s * 1664525 + 1013904223) % 4294967296;
      const idx = s % arr.length;
      if(!used.has(idx)){ used.add(idx); out.push(arr[idx]); }
    }
    return out;
  }

  /* ========== ××©×™××•×ª ×™×•××™×•×ª ========== */
  const DAILY_DONE_KEY = "daily_done_v1";
  function renderDaily(){
    document.getElementById('today-badge').textContent = new Date().toLocaleDateString('he-IL', {weekday:'long', day:'2-digit', month:'2-digit'});
    const container = document.getElementById('daily-list');
    const pick = seedPick(dailyTasks, 3);
    const done = JSON.parse(localStorage.getItem(DAILY_DONE_KEY) || "{}");
    container.innerHTML = pick.map(t => `
      <div class="p-4 rounded-xl border border-gray-100 flex items-start justify-between gap-3">
        <div class="flex-1">
          <div class="flex items-center gap-2">
            <span class="text-2xl">${t.icon}</span>
            <h3 class="font-semibold text-gray-800">${t.title}</h3>
            <span class="badge">${t.time}</span>
          </div>
          <p class="tiny mt-1">${t.tip}</p>
          <a class="link tiny" target="_blank" href="${t.video}">ğŸ¥ ×¡×¨×˜×•×Ÿ ×˜×™×¤×™× ×‘× ×•×©×</a>
        </div>
        <button data-id="${t.id}" class="btn ${done[t.id]?'bg-green-600 text-white':'btn-ghost'} toggle-done">
          ${done[t.id]?'×‘×•×¦×¢ âœ…':'×¡××Ÿ ×‘×•×¦×¢'}
        </button>
      </div>
    `).join('');
    container.querySelectorAll('.toggle-done').forEach(btn=>{
      btn.addEventListener('click',()=>{
        const id = btn.getAttribute('data-id');
        const map = JSON.parse(localStorage.getItem(DAILY_DONE_KEY) || "{}");
        map[id] = !map[id];
        localStorage.setItem(DAILY_DONE_KEY, JSON.stringify(map));
        renderDaily();
      });
    });
  }

  /* ========== ××•×¨×›×‘×•×ª ×œ×¡×•×¤"×© ========== */
  const WEEKLY_DONE_KEY = "weekly_done_v1";
  function renderWeekly(){
    const day = new Date().getDay(); // 5=Fri, 6=Sat
    const wrap = document.getElementById('weekly-card');
    if(day!==5 && day!==6){
      wrap.innerHTML = `<p class="tiny">×›×©×ª×’×™×¢×™ ×œ×¡×•×¤×´×©, ×ª×•×¤×™×¢ ×›××Ÿ ××©×™××” ××—×ª ×’×“×•×œ×” ğŸ™‚</p>`;
      return;
    }
    const [task] = seedPick(weekendTasks,1);
    const done = JSON.parse(localStorage.getItem(WEEKLY_DONE_KEY) || "{}");
    wrap.innerHTML = `
      <div class="p-4 rounded-xl border border-gray-100 flex items-start justify-between gap-3">
        <div class="flex-1">
          <div class="flex items-center gap-2">
            <span class="text-2xl">${task.icon}</span>
            <h3 class="font-semibold text-gray-800">${task.title}</h3>
          </div>
          <p class="tiny mt-1">×˜×™×¤: ${task.tip}</p>
          <a class="link tiny" target="_blank" href="${task.video}">ğŸ¬ ×¡×¨×˜×•×Ÿ ×”×©×¨××”/×©×™×˜×”</a>
        </div>
        <div class="flex flex-col gap-2">
          <button id="btn-weekly-done" class="btn ${done[task.id]?'bg-green-600 text-white':'btn-ghost'}">${done[task.id]?'×‘×•×¦×¢ âœ…':'×‘×•×¦×¢'}</button>
          <button id="btn-skip-week" class="btn btn-ghost">×“×œ×’ ×œ×©×‘×•×¢ ×”×‘× â­ï¸</button>
        </div>
      </div>
    `;
    document.getElementById('btn-weekly-done').onclick=()=>{
      const map = JSON.parse(localStorage.getItem(WEEKLY_DONE_KEY) || "{}");
      map[task.id]=!map[task.id]; localStorage.setItem(WEEKLY_DONE_KEY,JSON.stringify(map)); renderWeekly();
    };
    document.getElementById('btn-skip-week').onclick=()=>{
      // ××¡××Ÿ ×›××™×œ×• ×‘×•×¦×¢ ×›×“×™ ×œ×”×—×œ×™×£ ×‘×©×‘×•×¢ ×”×‘×
      const map = JSON.parse(localStorage.getItem(WEEKLY_DONE_KEY) || "{}");
      map[task.id]=true; localStorage.setItem(WEEKLY_DONE_KEY,JSON.stringify(map));
      location.reload();
    };
  }

  /* ========== ×ª×›× ×™×ª ×××•×§×“×ª ×œ××–×•×¨ â€“ ×¦×³×§Ö¾×œ×™×¡×˜ ========== */
  const AREA_KEY = "area_checklist_v2";
  function buildChecklistFromText(){
    const text = document.getElementById('steps-input').value;
    const items = text.split('\n')
      .map(s=>s.trim()).filter(Boolean)
      .map((t,idx)=>({ id:'i'+idx, text:t, done:false }));
    localStorage.setItem(AREA_KEY, JSON.stringify(items));
    renderChecklist();
  }
  function renderChecklist(showAll=false){
    const container = document.getElementById('checklist');
    const data = JSON.parse(localStorage.getItem(AREA_KEY) || "[]");
    const visible = showAll ? data : data.filter(x=>!x.done);
    container.innerHTML = visible.length ? visible.map(it=>`
      <label class="flex items-center gap-3 p-3 rounded-xl border border-gray-100">
        <input type="checkbox" ${it.done?'checked':''} data-id="${it.id}" class="h-5 w-5 rounded">
        <span class="${it.done?'line-through text-gray-400':''}">${it.text}</span>
      </label>
    `).join('') : `<p class="tiny">×¢×“×™×™×Ÿ ××™×Ÿ ×¦×¢×“×™×. ×”×“×‘×™×§×™ ×˜×§×¡×˜ ×•×œ×—×¦×™ â€œ×¦×•×¨/×¢×“×›×Ÿ ×¦×³×§Ö¾×œ×™×¡×˜â€.</p>`;
    container.querySelectorAll('input[type=checkbox]').forEach(cb=>{
      cb.addEventListener('change',()=>{
        const id = cb.getAttribute('data-id');
        const list = JSON.parse(localStorage.getItem(AREA_KEY) || "[]");
        const it = list.find(x=>x.id===id);
        if(it){ it.done = cb.checked; localStorage.setItem(AREA_KEY, JSON.stringify(list)); renderChecklist(showAll); }
      });
    });
  }
  document.getElementById('btn-build-checklist').onclick = buildChecklistFromText;
  document.getElementById('btn-hide-done').onclick = ()=> renderChecklist(false);
  document.getElementById('btn-show-all').onclick = ()=> renderChecklist(true);
  document.getElementById('btn-clear').onclick = ()=>{
    if(confirm('×œ× ×§×•×ª ××ª ×”×¦×³×§Ö¾×œ×™×¡×˜?')){ localStorage.removeItem(AREA_KEY); renderChecklist(true); }
  };

  /* ========== ×”×ª×¨××•×ª ×™×•××™×•×ª (××ª×•×§×Ÿ) ========== */
  const NOTIFY_KEY = "daily_notify";
  function updateNotifyUI() {
    const statusEl = document.getElementById("notify-status");
    const isOn = JSON.parse(localStorage.getItem(NOTIFY_KEY) || "false");
    if (statusEl) statusEl.textContent = isOn ? "×”×ª×–×›×•×¨×ª ×¤×¢×™×œ×”" : "×”×ª×–×›×•×¨×ª ×›×‘×•×™×”";
    const btn = document.getElementById("btn-notify-toggle");
    if (btn) btn.textContent = isOn ? "×›×‘×” ×ª×–×›×•×¨×ª" : "×”×¤×¢×œ ×ª×–×›×•×¨×ª";
  }
  async function enableNotifications() {
    if (!("Notification" in window)) { alert("×”×“×¤×“×¤×Ÿ ×œ× ×ª×•××š ×‘×”×ª×¨××•×ª"); return; }
    let perm = Notification.permission;
    if (perm === "default") perm = await Notification.requestPermission();
    if (perm !== "granted") { alert("×¦×¨×™×š ×œ××©×¨ ×§×‘×œ×ª ×”×ª×¨××•×ª ×‘×“×¤×“×¤×Ÿ"); return; }
    localStorage.setItem(NOTIFY_KEY, "true");
    scheduleDailyNotification();
    updateNotifyUI();
  }
  function disableNotifications() {
    localStorage.setItem(NOTIFY_KEY, "false");
    clearExistingTimers(); updateNotifyUI();
  }
  let notifyTimerId = null;
  function clearExistingTimers(){ if (notifyTimerId) clearTimeout(notifyTimerId); notifyTimerId=null; }
  function scheduleDailyNotification(){
    clearExistingTimers();
    const on = JSON.parse(localStorage.getItem(NOTIFY_KEY)||"false"); if(!on) return;
    const now = new Date();
    const start = new Date(now.getFullYear(), now.getMonth(), now.getDate(), 21, 0, 0);
    const end   = new Date(now.getFullYear(), now.getMonth(), now.getDate(), 22, 0, 0);
    let msUntil = start - now;
    if (msUntil < 0) {
      msUntil = end - now;
      if (msUntil < 0) msUntil = start.getTime()+24*60*60*1000 - now.getTime(); // ×œ××—×¨
    }
    notifyTimerId = setTimeout(()=>{ fireNotification(); scheduleDailyNotification(); }, msUntil);
  }
  function fireNotification(){
    try{
      if("Notification" in window && Notification.permission==="granted"){
        new Notification("×–××Ÿ ×œ× ×™×§×™×•×Ÿ! ğŸ ",{ body:"×”×’×™×¢ ×”×–××Ÿ ×œ××©×™××•×ª ×”×‘×™×ª ×©×œ×š" });
      }
      const el = document.createElement("div");
      el.textContent = "×–××Ÿ ×œ× ×™×§×™×•×Ÿ! ×”×’×™×¢ ×”×–××Ÿ ×œ××©×™××•×ª ğŸ§½";
      el.style.cssText="position:fixed;top:16px;left:16px;right:16px;background:#7c3aed;color:#fff;padding:12px 14px;border-radius:12px;box-shadow:0 10px 25px rgba(0,0,0,.2);z-index:9999;text-align:center";
      document.body.appendChild(el); setTimeout(()=>el.remove(), 3500);
    }catch(e){}
  }
  document.getElementById("btn-notify-test").addEventListener("click", fireNotification);
  document.getElementById("btn-notify-toggle").addEventListener("click", ()=>{
    const on = JSON.parse(localStorage.getItem(NOTIFY_KEY)||"false");
    if(on) disableNotifications(); else enableNotifications();
  });

  /* ========== ××ª×—×•×œ ========== */
  document.addEventListener('DOMContentLoaded', ()=>{
    renderDaily(); renderWeekly(); renderChecklist(true);
    updateNotifyUI(); if(JSON.parse(localStorage.getItem(NOTIFY_KEY)||"false")) scheduleDailyNotification();
  });
  </script>
</body>
</html>
